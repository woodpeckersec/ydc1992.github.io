window._bd_share_main.F.module("trans/trans_weixin",function(n,i){var e,o,d,t="bdshare_weixin_qrcode_dialog",a="",r=0,c={},p=n("base/tangram").T,s=(n("conf/const").URLS,function(n){var i=Math.round(200/n.length),e=['<table style="direction:ltr;border: 0; width:'+(r=(i=2>i?2:i)*n.length)+'px; border-collapse: collapse;background-color:#fff;margin:0 auto;" align="center">'],o="";return p.each(n,function(n,d){e.push("<tr>"),p.each(d,function(n,d){o='<td style="width:'+i+"px;height:"+i+"px;padding:0;margin:0;border:none;background:#"+(d?"000":"FFF")+'"></td>',e.push(o)})}),e.push("</table>"),e.join("")}),u=function(){var n;e.attr("data-url")!=a&&(d.html("正在加载"),a.length,n=a,window._bd_share_main.F.use("component/qrcode",function(i){var o=new(0,i.QRCode)(-1,i.QRErrorCorrectLevel.L);o.addData(n),o.make();var t=s(o.modules);p(t).appendTo(d.empty()),_(r),h(),e.attr("data-url",n)}))},_=function(n){var i=(n>220?n:220)+20,o=p(".bd_weixin_popup_foot").height()+p(".bd_weixin_popup_head").height()+n+30;e.css({width:i,height:o})},f=function(){e.find(".bd_weixin_popup_close").click(w),p("body").on("keydown",function(n){27==n.keyCode&&w()}),p(window).resize(function(){h()})},h=function(){var n=p(window).scrollTop(),i=e.outerWidth(),d=e.outerHeight(),t=p(window).width(),a=(p(window).height()-d)/2+n,r=(t-i)/2;a=0>a?0:a,r=0>r?0:r,o.width(i).height(d).css({left:r,top:a}),e.css({left:r,top:a})},l=function(){e.show(),o.show(),h()},w=function(){e.hide(),o.hide()},b=function(n){n=function(n){var i="10006-weixin-1-52626-6b3bffd01fdde4900130bc5a2751b6d1";if("off"===c.sign)return n;if("normal"===c.sign){var e=n.indexOf("#"),o=n.indexOf("?");return-1==e?n+(-1==o?"?":"&")+i:n.replace("#",(-1==o?"?":"&")+i+"#")}return n.replace(/#.*$/g,"")+"#"+i}(n);var i=[];return p.each(n,function(n,e){/[^\x00-\xff]/.test(e)?i[n]=encodeURI(e):i[n]=e}),i.join("")};i.run=function(n){c=n,a=b(n.url),window._bd_share_main.F.use("weixin_popup.css",function(){window._bd_share_main.F.use("component/pop_dialog",function(n){n.Dialog.hide()}),function(){if(e=p("#"+t),o=p("#"+t+"_bg"),e.length<1){var n=['<div id="'+t+'" class="bd_weixin_popup">','<div class="bd_weixin_popup_head">',"<span>分享到微信朋友圈</span>",'<a href="#" onclick="return false;" class="bd_weixin_popup_close">&times;</a>',"</div>",'<div id="'+t+'_qr" class="bd_weixin_popup_main"></div>','<div class="bd_weixin_popup_foot">打开微信，点击底部的“发现”，<br>使用“扫一扫”即可将网页分享至朋友圈。</div>',"</div>"].join("");o=p('<iframe id="bdshare_weixin_qrcode_dialog_bg" class="bd_weixin_popup_bg"></iframe>').appendTo("body"),e=p(n).appendTo("body"),f()}d=e.find("#"+t+"_qr"),l()}(),u()})}});